<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lugaz - Comparador de Luz</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --grad: linear-gradient(135deg, #0f172a 0%, #1e40af 50%, #0ea5e9 100%); }
        * { margin:0; padding:0; box-sizing:border-box; }
        body { font-family: 'Poppins', sans-serif; background: var(--grad); color: white; min-height: 100vh; padding: 20px; display: flex; align-items: center; justify-content: center; }
        .card { background: rgba(255,255,255,0.1); backdrop-filter: blur(15px); border-radius: 24px; padding: 40px; width: 100%; max-width: 500px; box-shadow: 0 20px 50px rgba(0,0,0,0.4); }
        h1 { font-size: 3.5rem; text-align: center; background: linear-gradient(to right, #60a5fa, #a5f3fc); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 10px; }
        p { text-align: center; font-size: 1.4rem; margin-bottom: 30px; color: #e2e8f0; }
        input { width: 100%; padding: 16px; margin: 12px 0; background: rgba(255,255,255,0.15); border: none; border-radius: 12px; color: white; font-size: 1.1rem; }
        input::placeholder { color: #cbd5e1; }
        button { width: 100%; padding: 18px; background: #0ea5e9; color: white; border: none; border-radius: 12px; font-size: 1.3rem; cursor: pointer; margin-top: 20px; }
        button:hover { background: #0c8bd4; }
        .resultado { margin-top: 50px; display: grid; gap: 20px; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); }
        .tarifa { background: rgba(255,255,255,0.1); padding: 25px; border-radius: 16px; text-align: center; transition: 0.3s; }
        .tarifa:hover { transform: translateY(-10px); box-shadow: 0 20px 40px rgba(0,0,0,0.4); }
        .empresa { font-size: 1.8rem; font-weight: 700; }
        .precio { font-size: 2.8rem; color: #34d399; margin: 10px 0; }
        .ahorro { font-size: 1.3rem; color: #fbbf24; }
    </style>
</head>
<body>
    <div class="card">
        <h1>Lugaz</h1>
        <p>Compara y ahorra hasta 400€ al año</p>
        
        <input type="email" id="email" placeholder="Tu email" required>
        <input type="number" id="consumo" placeholder="Consumo mensual (kWh) → ej: 320" required>
        <input type="number" step="0.01" id="potencia" placeholder="Potencia contratada (kW) → ej: 5.75" value="5.75" required>
        <input type="number" step="0.01" id="gasto" placeholder="Gasto actual en factura (€) → ej: 78.45" required>
        
        <button onclick="calcular()">¡Descubre cuánto ahorras!</button>
        
        <div id="resultado" class="resultado"></div>
    </div>

    <script>
        const tarifas = [
            { empresa: "Endesa", nombre: "Permanencia 12 meses", kwh: 0.108, pot_punta: 0.122, pot_valle: 0.052, descuento: 28 },
            { empresa: "Iberdrola", nombre: "Sin permanencia", kwh: 0.112, pot_punta: 0.124, pot_valle: 0.054, descuento: 22 },
            { empresa: "Eleia", nombre: "Permanencia 12 meses", kwh: 0.115, pot_punta: 0.130, pot_valle: 0.045, descuento: 35 },
            { empresa: "Plenitude", nombre: "Sin permanencia", kwh: 0.104, pot_punta: 0.118, pot_valle: 0.050, descuento: 20 }
        ];

        function calcular() {
            const email = document.getElementById("email").value.trim();
            const consumo = parseFloat(document.getElementById("consumo").value) || 350;
            const potencia = parseFloat(document.getElementById("potencia").value) || 5.75;
            const gastoActual = parseFloat(document.getElementById("gasto").value) || 85;
            const alquiler = 0.81;
            const dias = 30;

            if (!email || !consumo || !potencia || !gastoActual) {
                alert("Rellena todos los campos");
                return;
            }

            // Guardar email
            fetch("https://script.google.com/macros/s/AKfycbxVi6XhMv1YpI2qZU97Rao8DhUdg0esgMJr3JdZEU05xhPnhiG_UWRq5LxbyD0QnHYw/exec?email=" + encodeURIComponent(email));

            let html = '<h2 style="grid-column:1/-1; text-align:center; color:#a5f3fc; margin:30px 0;">¡Tus mejores ofertas!</h2>';

            tarifas.forEach(t => {
                const energia = consumo * t.kwh;
                const potenciaCoste = (potencia * t.pot_punta * dias) + (potencia * t.pot_valle * dias);
                const base = energia + potenciaCoste;
                const impuesto = base * 0.05113;
                const baseIVA = base + impuesto + alquiler;
                const iva = baseIVA * 0.21;
                const totalSinDesc = baseIVA + iva;
                const totalConDesc = totalSinDesc * (1 - t.descuento / 100);
                const ahorroAnual = Math.round((gastoActual - totalConDesc) * 12);

                html += `
                    <div class="tarifa">
                        <div class="empresa">${t.empresa}</div>
                        <div style="color:#94a3b8; margin:8px 0;">${t.nombre}</div>
                        <div class="precio">${totalConDesc.toFixed(0)}€/mes</div>
                        <div class="ahorro">¡Ahorras ${ahorroAnual}€ al año!</div>
                        <div style="margin-top:10px; color:#94a3b8; font-size:0.9rem;">-${t.descuento}% primer año</div>
                    </div>
                `;
            });

            document.getElementById("resultado").innerHTML = html;
        }
    </script>
</body>
</html>
